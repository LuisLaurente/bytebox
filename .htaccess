# Configuraciones de seguridad para PHP
<IfModule mod_php7.c>
    php_flag session.use_strict_mode On
    php_flag session.use_only_cookies On
    php_flag session.cookie_httponly On
    php_value session.cookie_samesite "Lax"
    php_flag session.cookie_secure Off
</IfModule>

<IfModule mod_php.c>
    php_flag session.use_strict_mode On
    php_flag session.use_only_cookies On
    php_flag session.cookie_httponly On
    php_value session.cookie_samesite "Lax"
    php_flag session.cookie_secure Off
</IfModule>

# Evitar listado de directorios
Options -Indexes

# Proteger archivos sensibles
<FilesMatch "^(\.env|.*\.log|composer\.json|composer\.lock|\.htaccess)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# ==========================================
# REDIRECCIÓN A CARPETA PUBLIC - COMPATIBLE AMBOS ENTORNOS
# ==========================================
RewriteEngine On

# DETECTAR SI ESTAMOS EN LOCAL (por la presencia de /bytebox/)
RewriteCond %{REQUEST_URI} ^/bytebox/
RewriteRule ^ - [E=IS_LOCAL:1]

# REDIRECCIÓN DE LA RAÍZ
# Para LOCAL: /bytebox/ → /bytebox/public/
RewriteCond %{ENV:IS_LOCAL} 1
RewriteRule ^bytebox/?$ /bytebox/public/ [L]

# Para PRODUCCIÓN: / → /public/  
RewriteCond %{ENV:IS_LOCAL} !1
RewriteRule ^$ public/ [L]

# REDIRECCIÓN DE RUTAS
# Para LOCAL: /bytebox/cualquier-cosa → /bytebox/public/cualquier-cosa
RewriteCond %{ENV:IS_LOCAL} 1
RewriteCond %{REQUEST_URI} !^/bytebox/public/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^bytebox/(.*)$ /bytebox/public/$1 [L]

# Para PRODUCCIÓN: /cualquier-cosa → /public/cualquier-cosa
RewriteCond %{ENV:IS_LOCAL} !1
RewriteCond %{REQUEST_URI} !^/public/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ public/$1 [L]

# php -- BEGIN cPanel-generated handler, do not edit
# This domain inherits the “PHP” package.
# php -- END cPanel-generated handler, do not edit